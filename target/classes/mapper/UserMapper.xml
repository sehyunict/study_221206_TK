<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



       
<mapper namespace="sehyunict.tk.user.service.UserDao">


	<!-- 회원정보 가져오기 -->
	<select id="getUserInfo" parameterType="UserVo" resultType="UserVo">
		SELECT 
			USER_ID
		   ,USER_NAME
		   ,USER_PWD
		   ,USER_EMAIL
		   ,USER_PHONE
		  FROM 
		  	TN_TK_USER
		 WHERE 
		 	USER_ID=#{userId}
		   
	</select>
	<!-- 회원정보 수정하기 -->
	<update id="updateUserInfo" parameterType="UserVo">
		UPDATE 
			TN_TK_USER
		   SET 
		   	USER_NAME=#{userName}
		   ,USER_EMAIL=#{userEmail}
		   ,USER_PWD=#{userPwd}
		   ,USER_PHONE=#{userPhone}
		 WHERE
		 	USER_ID=#{userId}
	
	</update>
	
	<!-- 비밀번호 체크 -->
	<select id="pwCheck" resultType="UserVo">
		SELECT
			USER_PWD
		  FROM
		  	TN_TK_USER
		 WHERE
		 	USER_PWD=#{user_pwd}
	
	</select>
	
	
	<!-- 내가 쓴 리뷰 목록 -->
	<select id="getMyReview" parameterType="map" resultType="UserVo">
		SELECT 
			R.TITLE
		   ,R.CONTENT
		   ,R.STAR
		   ,U.USER_NAME
           ,I.TITLE as movie_title
		  FROM 
		    TN_TK_REVIEW R
		   ,TN_TK_USER U
		   ,TN_TK_TIMETABLE T
           ,TN_TK_ITEM I
		 WHERE 
		 	R.USER_ID=U.USER_ID
           AND
            R.TIMETABLE_ID=T.TIMETABLE_ID
           AND
            T.ITEM_ID=I.ITEM_ID 
		   AND 
		    R.USER_ID=#{userId}
	  ORDER BY 
	  		REVIEW_ID
	</select>
	
	<!-- 리뷰 삭제 하기 -->
	<delete id="deleteMyReview" parameterType="userVo">
		DELETE FROM
			TN_TK_REVIEW
		 WHERE REVIEW_ID=#{reviewId}
	</delete>
	
	<!-- 내가 쓴 문의사항 목록 -->
	<select id="getMyQna" parameterType="map" resultType="UserVo">
		SELECT
			Q.TITLE
		   ,Q.QNA_TITLE
		   ,Q.QNA_CONTENT
		   ,U.USER_NAME
		   ,Q.CREATED_AT
		  FROM
		  	TN_TK_QNA Q
		   ,TN_TK_USER U
		 WHERE
	
	</select>
	



</mapper>
        
   